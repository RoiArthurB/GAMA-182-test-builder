# This workflow will build different GAMA release
# For more information see: https://github.com/actions/setup-java#apache-maven-with-a-settings-path

name: GAMA Generator

on:
  # Triggers the workflow on push or pull request events but only for the master branch
  push:
    branches: [ main ]
  workflow_dispatch:  # For manual trigger


jobs:

  # ======================================================================
  # JDK 11 - Hotspot
  # ======================================================================
  
  jdk11-HotSpot-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      # - name: Change SWT
      #   run: |
      #     # POM
      #     sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03/Linux-jdk11-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03/Windows-jdk11-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03/MacOS-jdk11-HotSpot-SWT_2021-03.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-03
          path: ./jdk11-HotSpot-SWT_2021-03
    
  # ---
  
  jdk11-HotSpot-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06/Linux-jdk11-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06/Windows-jdk11-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06/MacOS-jdk11-HotSpot-SWT_2021-06.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-06
          path: ./jdk11-HotSpot-SWT_2021-06
    
  # ---
  
  jdk11-HotSpot-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09/Linux-jdk11-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09/Windows-jdk11-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09/MacOS-jdk11-HotSpot-SWT_2021-09.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-09
          path: ./jdk11-HotSpot-SWT_2021-09
    
  # ---
  
  jdk11-HotSpot-SWT_2021-12:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-12
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-12/Linux-jdk11-HotSpot-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-12/Windows-jdk11-HotSpot-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-12/MacOS-jdk11-HotSpot-SWT_2021-12.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-12

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-12
          path: ./jdk11-HotSpot-SWT_2021-12

  # ======================================================================
  # JDK 11 - OpenJ9
  # ======================================================================
  
  jdk11-OpenJ9-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      #- name: Change SWT
      #  run: |
      #    # POM
      #    sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #    sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #    sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03/Linux-jdk11-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03/Windows-jdk11-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03/MacOS-jdk11-OpenJ9-SWT_2021-03.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-03
          path: ./jdk11-OpenJ9-SWT_2021-03

  # ---
  
  jdk11-OpenJ9-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06/Linux-jdk11-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06/Windows-jdk11-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06/MacOS-jdk11-OpenJ9-SWT_2021-06.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-06
          path: ./jdk11-OpenJ9-SWT_2021-06
    
  # ---
  
  jdk11-OpenJ9-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09/Linux-jdk11-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09/Windows-jdk11-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09/MacOS-jdk11-OpenJ9-SWT_2021-09.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-09
          path: ./jdk11-OpenJ9-SWT_2021-09
    
  # ---
  
  jdk11-OpenJ9-SWT_2021-12:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-12
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-12/Linux-jdk11-OpenJ9-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-12/Windows-jdk11-OpenJ9-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-12/MacOS-jdk11-OpenJ9-SWT_2021-12.zip
          ls -lh $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-12

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-12
          path: ./jdk11-OpenJ9-SWT_2021-12

  # ======================================================================
  # JDK 16 - HotSpot
  # ======================================================================

  jdk16-HotSpot-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up Adoptium 16
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '16'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_linux_hotspot_16.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_windows_hotspot_16.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_mac_hotspot_16.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      # - name: Change SWT
      #   run: |
      #     # POM
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-03/Linux-jdk16-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-03/Windows-jdk16-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-03/MacOS-jdk16-HotSpot-SWT_2021-03.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-03

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-03
          path: ./jdk16-HotSpot-SWT_2021-03
  
  # ---

  jdk16-HotSpot-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up Adoptium 16
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '16'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_linux_hotspot_16.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_windows_hotspot_16.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_mac_hotspot_16.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-06/Linux-jdk16-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-06/Windows-jdk16-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-06/MacOS-jdk16-HotSpot-SWT_2021-06.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-06

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-06
          path: ./jdk16-HotSpot-SWT_2021-06
  
  # ---

  jdk16-HotSpot-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up Adoptium 16
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '16'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_linux_hotspot_16.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_windows_hotspot_16.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_mac_hotspot_16.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-09/Linux-jdk16-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-09/Windows-jdk16-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-09/MacOS-jdk16-HotSpot-SWT_2021-09.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-09

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-09
          path: ./jdk16-HotSpot-SWT_2021-09
  
  # ---

  jdk16-HotSpot-SWT_2021-12:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up Adoptium 16
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '16'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_linux_hotspot_16.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_windows_hotspot_16.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin16-binaries\/releases\/download\/jdk-16.0.2%2B7\/OpenJDK16U-jdk_x64_mac_hotspot_16.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-12
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-12/Linux-jdk16-HotSpot-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-12/Windows-jdk16-HotSpot-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-12/MacOS-jdk16-HotSpot-SWT_2021-12.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-HotSpot-SWT_2021-12

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-12
          path: ./jdk16-HotSpot-SWT_2021-12

  # ======================================================================
  # JDK 16 - OpenJ9
  # ======================================================================
  
  jdk16-OpenJ9-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'

      - run: |
          download_url="https://github.com/ibmruntimes/semeru16-binaries/releases/download/jdk-16.0.2%2B7_openj9-0.27.0/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz"
          wget -O $RUNNER_TEMP/java_package.tar.gz $download_url
      - name: Set up IBM Semeru 16-OpenJ9
        uses: actions/setup-java@v2
        with:
          distribution: 'jdkfile'
          jdkFile: ${{ runner.temp }}/java_package.tar.gz
          java-version: '16.0.2'
          architecture: x64
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_windows_16.0.2_7_openj9-0.27.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_mac_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      # - name: Change SWT
      #   run: |
      #     # POM
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-03/Linux-jdk16-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-03/Windows-jdk16-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-03/MacOS-jdk16-OpenJ9-SWT_2021-03.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-03

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-03
          path: ./jdk16-OpenJ9-SWT_2021-03
  
  # ---

  jdk16-OpenJ9-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'

      - run: |
          download_url="https://github.com/ibmruntimes/semeru16-binaries/releases/download/jdk-16.0.2%2B7_openj9-0.27.0/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz"
          wget -O $RUNNER_TEMP/java_package.tar.gz $download_url
      - name: Set up IBM Semeru 16-OpenJ9
        uses: actions/setup-java@v2
        with:
          distribution: 'jdkfile'
          jdkFile: ${{ runner.temp }}/java_package.tar.gz
          java-version: '16.0.2'
          architecture: x64
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_windows_16.0.2_7_openj9-0.27.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_mac_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-06/Linux-jdk16-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-06/Windows-jdk16-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-06/MacOS-jdk16-OpenJ9-SWT_2021-06.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-06

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-06
          path: ./jdk16-OpenJ9-SWT_2021-06
  
  # ---

  jdk16-OpenJ9-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'

      - run: |
          download_url="https://github.com/ibmruntimes/semeru16-binaries/releases/download/jdk-16.0.2%2B7_openj9-0.27.0/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz"
          wget -O $RUNNER_TEMP/java_package.tar.gz $download_url
      - name: Set up IBM Semeru 16-OpenJ9
        uses: actions/setup-java@v2
        with:
          distribution: 'jdkfile'
          jdkFile: ${{ runner.temp }}/java_package.tar.gz
          java-version: '16.0.2'
          architecture: x64
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_windows_16.0.2_7_openj9-0.27.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_mac_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-09/Linux-jdk16-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-09/Windows-jdk16-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-09/MacOS-jdk16-OpenJ9-SWT_2021-09.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-09

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-09
          path: ./jdk16-OpenJ9-SWT_2021-09
  
  # ---

  jdk16-OpenJ9-SWT_2021-12:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'

      - run: |
          download_url="https://github.com/ibmruntimes/semeru16-binaries/releases/download/jdk-16.0.2%2B7_openj9-0.27.0/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz"
          wget -O $RUNNER_TEMP/java_package.tar.gz $download_url
      - name: Set up IBM Semeru 16-OpenJ9
        uses: actions/setup-java@v2
        with:
          distribution: 'jdkfile'
          jdkFile: ${{ runner.temp }}/java_package.tar.gz
          java-version: '16.0.2'
          architecture: x64
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>16/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget -q \$\(.*linux.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_linux_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*windows.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_windows_16.0.2_7_openj9-0.27.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget -q \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/ibmruntimes\/semeru16-binaries\/releases\/download\/jdk-16.0.2%2B7_openj9-0.27.0\/ibm-semeru-open-jdk_x64_mac_16.0.2_7_openj9-0.27.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-16\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-12/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-12
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-12/Linux-jdk16-OpenJ9-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-12/Windows-jdk16-OpenJ9-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-12/MacOS-jdk16-OpenJ9-SWT_2021-12.zip
          ls -lh $GITHUB_WORKSPACE/jdk16-OpenJ9-SWT_2021-12

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-12
          path: ./jdk16-OpenJ9-SWT_2021-12

  # ======================================================================
  # JDK 17 - HotSpot
  # ======================================================================

  jdk17-HotSpot-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2_jdk17'
      
      - name: Set up Temurin 17
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '17'
          java-package: jdk
          cache: 'maven'

      - name: Change SWT
       run: |
         # POM
         sed -i 's/releases\/2021-12/releases\/2021-03/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
         sed -i 's/releases\/2021-12/releases\/2021-03/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
         sed -i 's/releases\/2021-12/releases\/2021-03/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-03/Linux-jdk17-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-03/Windows-jdk17-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-03/MacOS-jdk17-HotSpot-SWT_2021-03.zip
          ls -lh $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-03

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-03
          path: ./jdk17-HotSpot-SWT_2021-03
  
  # ---

  jdk17-HotSpot-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2_jdk17'
      
      - name: Set up Temurin 17
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '17'
          java-package: jdk
          cache: 'maven'

      - name: Change SWT
       run: |
         # POM
         sed -i 's/releases\/2021-12/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
         sed -i 's/releases\/2021-12/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
         sed -i 's/releases\/2021-12/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-06/Linux-jdk17-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-06/Windows-jdk17-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-06/MacOS-jdk17-HotSpot-SWT_2021-06.zip
          ls -lh $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-06

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-06
          path: ./jdk17-HotSpot-SWT_2021-06
  
  # ---

  jdk17-HotSpot-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2_jdk17'
      
      - name: Set up Temurin 17
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '17'
          java-package: jdk
          cache: 'maven'

      - name: Change SWT
       run: |
         # POM
         sed -i 's/releases\/2021-12/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
         sed -i 's/releases\/2021-12/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
         sed -i 's/releases\/2021-12/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-09/Linux-jdk17-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-09/Windows-jdk17-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-09/MacOS-jdk17-HotSpot-SWT_2021-09.zip
          ls -lh $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-09

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-09
          path: ./jdk17-HotSpot-SWT_2021-09
  
  # ---

  jdk17-HotSpot-SWT_2021-12:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2_jdk17'
      
      - name: Set up Temurin 17
        uses: actions/setup-java@v2 
        with:
          distribution: 'temurin'
          java-version: '17'
          java-package: jdk
          cache: 'maven'

      #- name: Change SWT
      # run: |
      #   # POM
      #   sed -i 's/releases\/2021-12/releases\/2021-03/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #   sed -i 's/releases\/2021-12/releases\/2021-03/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #   sed -i 's/releases\/2021-12/releases\/2021-03/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-12
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-12/Linux-jdk17-HotSpot-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-12/Windows-jdk17-HotSpot-SWT_2021-12.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-12/MacOS-jdk17-HotSpot-SWT_2021-12.zip
          ls -lh $GITHUB_WORKSPACE/jdk17-HotSpot-SWT_2021-12

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-12
          path: ./jdk17-HotSpot-SWT_2021-12

  # ======================================================================
  # JDK 17 - OpenJ9
  # ======================================================================
  
  # Not yet 🤷

  # ======================================================================
  # Gather
  # ======================================================================

  gather_JDK11:
    needs: [jdk11-HotSpot-SWT_2021-03, jdk11-HotSpot-SWT_2021-06, jdk11-HotSpot-SWT_2021-09, jdk11-HotSpot-SWT_2021-12, jdk11-OpenJ9-SWT_2021-03, jdk11-OpenJ9-SWT_2021-06, jdk11-OpenJ9-SWT_2021-09, jdk11-OpenJ9-SWT_2021-12]
    runs-on: ubuntu-latest
    steps:

      - name: Get every builds
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          mkdir ./artifacts
          mkdir ./release

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-03
          path: ./artifacts/jdk11-HotSpot-SWT_2021-03

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-06
          path: ./artifacts/jdk11-HotSpot-SWT_2021-06

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-09
          path: ./artifacts/jdk11-HotSpot-SWT_2021-09

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-HotSpot-SWT_2021-12
          path: ./artifacts/jdk11-HotSpot-SWT_2021-12

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-03
          path: ./artifacts/jdk11-OpenJ9-SWT_2021-03

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-06
          path: ./artifacts/jdk11-OpenJ9-SWT_2021-06

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-09
          path: ./artifacts/jdk11-OpenJ9-SWT_2021-09

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11-OpenJ9-SWT_2021-12
          path: ./artifacts/jdk11-OpenJ9-SWT_2021-12

      - name: Prepare releases
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          find ./artifacts -name "*zip" -exec mv {} ./release/ \;
          ls -lh ./release

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11
          path: ./release/*zip

  gather_JDK16:
    needs: [jdk16-HotSpot-SWT_2021-03, jdk16-HotSpot-SWT_2021-06, jdk16-HotSpot-SWT_2021-09, jdk16-HotSpot-SWT_2021-12, jdk16-OpenJ9-SWT_2021-03, jdk16-OpenJ9-SWT_2021-06, jdk16-OpenJ9-SWT_2021-09, jdk16-OpenJ9-SWT_2021-12]
    runs-on: ubuntu-latest
    steps:

      - name: Get every builds
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          mkdir ./artifacts
          mkdir ./release

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-03
          path: ./artifacts/jdk16-HotSpot-SWT_2021-03

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-06
          path: ./artifacts/jdk16-HotSpot-SWT_2021-06

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-09
          path: ./artifacts/jdk16-HotSpot-SWT_2021-09

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-HotSpot-SWT_2021-12
          path: ./artifacts/jdk16-HotSpot-SWT_2021-12

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-03
          path: ./artifacts/jdk16-OpenJ9-SWT_2021-03

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-06
          path: ./artifacts/jdk16-OpenJ9-SWT_2021-06

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-09
          path: ./artifacts/jdk16-OpenJ9-SWT_2021-09

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16-OpenJ9-SWT_2021-12
          path: ./artifacts/jdk16-OpenJ9-SWT_2021-12

      - name: Prepare releases
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          find ./artifacts -name "*zip" -exec mv {} ./release/ \;
          ls -lh ./release

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16
          path: ./release/*zip

  gather_JDK17:
    needs: [jdk17-HotSpot-SWT_2021-03, jdk17-HotSpot-SWT_2021-06, jdk17-HotSpot-SWT_2021-09, jdk17-HotSpot-SWT_2021-12]
    runs-on: ubuntu-latest
    steps:

      - name: Get every builds
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          mkdir ./artifacts
          mkdir ./release

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-03
          path: ./artifacts/jdk17-HotSpot-SWT_2021-03

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-06
          path: ./artifacts/jdk17-HotSpot-SWT_2021-06

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-09
          path: ./artifacts/jdk17-HotSpot-SWT_2021-09

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17-HotSpot-SWT_2021-12
          path: ./artifacts/jdk17-HotSpot-SWT_2021-12

      #- uses: actions/download-artifact@master
      #  if: always()
      #  env:
      #    working_directory: $GITHUB_WORKSPACE
      #  with:
      #    name: jdk17-OpenJ9-SWT_2021-03
      #    path: ./artifacts/jdk17-OpenJ9-SWT_2021-03
      #    
      #- uses: actions/download-artifact@master
      #  if: always()
      #  env:
      #    working_directory: $GITHUB_WORKSPACE
      #  with:
      #    name: jdk17-OpenJ9-SWT_2021-06
      #    path: ./artifacts/jdk17-OpenJ9-SWT_2021-06
      #    
      #- uses: actions/download-artifact@master
      #  if: always()
      #  env:
      #    working_directory: $GITHUB_WORKSPACE
      #  with:
      #    name: jdk17-OpenJ9-SWT_2021-09
      #    path: ./artifacts/jdk17-OpenJ9-SWT_2021-09

      - name: Prepare releases
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          find ./artifacts -name "*zip" -exec mv {} ./release/ \;
          ls -lh ./release

      - uses: actions/upload-artifact@master
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17
          path: ./release/*zip

  # ======================================================================
  # ----------------------------------------------------------------------
  # ====================================================================== 
  
  lets-publish:
    needs: [gather_JDK11, gather_JDK16, gather_JDK17]
    runs-on: ubuntu-latest
    steps:

      - name: Get every builds
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          mkdir ./artifacts
          mkdir ./release

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk11
          path: ./artifacts/jdk11

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk16
          path: ./artifacts/jdk16

      - uses: actions/download-artifact@master
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          name: jdk17
          path: ./artifacts/jdk17

      - name: Prepare releases
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          find ./artifacts -name "*zip" -exec mv {} ./release/ \;
          ls -lh ./release

      - name: Prepare per OS zip
        if: always()
        env:
          working_directory: $GITHUB_WORKSPACE
        run: |
          # Linux
          zip Linux-All-In-One.zip ./release/Linux-*
          mv Linux-All-In-One.zip ./release
          # Windows
          zip Windows-All-In-One.zip ./release/Windows-*
          mv Windows-All-In-One.zip ./release
          # MacOS
          zip MacOS-All-In-One.zip ./release/MacOS-*
          mv MacOS-All-In-One.zip ./release

      - uses: "marvinpinto/action-automatic-releases@latest"
        env:
          working_directory: $GITHUB_WORKSPACE
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          automatic_release_tag: "latest"
          prerelease: false
          title: "Development Build"
          files: ./release/*.zip
