# This workflow will build different GAMA release
# For more information see: https://github.com/actions/setup-java#apache-maven-with-a-settings-path

name: GAMA Generator

on:
  # Triggers the workflow on push or pull request events but only for the master branch
  push:
    branches: [ main ]
  workflow_dispatch:  # For manual trigger


jobs:
  
  jdk11-HotSpot-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      # - name: Change SWT
      #   run: |
      #     # POM
      #     sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03/Linux-jdk11-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03/Windows-jdk11-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03/MacOS-jdk11-HotSpot-SWT_2021-03.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk11-HotSpot-SWT_2021-03
          path: $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-03
    
  # ---
  
  jdk11-HotSpot-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06/Linux-jdk11-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06/Windows-jdk11-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06/MacOS-jdk11-HotSpot-SWT_2021-06.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk11-HotSpot-SWT_2021-06
          path: $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-06
    
  # ---
  
  jdk11-HotSpot-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_linux_hotspot_11.0.12_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_windows_hotspot_11.0.12_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/adoptium\/temurin11-binaries\/releases\/download\/jdk-11.0.12%2B7\/OpenJDK11U-jdk_x64_mac_hotspot_11.0.12_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09/Linux-jdk11-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09/Windows-jdk11-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09/MacOS-jdk11-HotSpot-SWT_2021-09.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk11-HotSpot-SWT_2021-09
          path: $GITHUB_WORKSPACE/jdk11-HotSpot-SWT_2021-09

  # ======================================================================
  
  jdk11-OpenJ9-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      #- name: Change SWT
      #  run: |
      #    # POM
      #    sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #    sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #    sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03/Linux-jdk11-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03/Windows-jdk11-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03/MacOS-jdk11-OpenJ9-SWT_2021-03.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk11-OpenJ9-SWT_2021-03
          path: $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-03

  # ---
  
  jdk11-OpenJ9-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06/Linux-jdk11-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06/Windows-jdk11-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06/MacOS-jdk11-OpenJ9-SWT_2021-06.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk11-OpenJ9-SWT_2021-06
          path: $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-06
    
  # ---
  
  jdk11-OpenJ9-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 11 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '11'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # POM
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          # Moving zip
          sed -i 's/jdk-15\*/jdk-11\*/g' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09/Linux-jdk11-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09/Windows-jdk11-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09/MacOS-jdk11-OpenJ9-SWT_2021-09.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk11-OpenJ9-SWT_2021-09
          path: $GITHUB_WORKSPACE/jdk11-OpenJ9-SWT_2021-09

  # ======================================================================

  jdk15-HotSpot-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 15 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '15'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # # POM
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_linux_hotspot_15.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_windows_hotspot_15.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_mac_hotspot_15.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      # - name: Change SWT
      #   run: |
      #     # POM
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-03/Linux-jdk15-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-03/Windows-jdk15-HotSpot-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-03/MacOS-jdk15-HotSpot-SWT_2021-03.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk15-HotSpot-SWT_2021-03
          path: $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-03
    
  # ---
  
  jdk15-HotSpot-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 15 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '15'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # # POM
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_linux_hotspot_15.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_windows_hotspot_15.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_mac_hotspot_15.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-06/Linux-jdk15-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-06/Windows-jdk15-HotSpot-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-06/MacOS-jdk15-HotSpot-SWT_2021-06.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk15-HotSpot-SWT_2021-06
          path: $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-06
  
  # ---
  
  jdk15-HotSpot-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 15 Hotspot
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-hotspot'
          java-version: '15'
          java-package: jdk
          cache: 'maven'

      - name: Change JDK
        run: |
          # # POM
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          # sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
          # Zipped JDK
          sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_linux_hotspot_15.0.2_7.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_windows_hotspot_15.0.2_7.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
          sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk15-binaries\/releases\/download\/jdk-15.0.2%2B7\/OpenJDK15U-jdk_x64_mac_hotspot_15.0.2_7.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-09/Linux-jdk15-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-09/Windows-jdk15-HotSpot-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-09/MacOS-jdk15-HotSpot-SWT_2021-09.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk15-HotSpot-SWT_2021-09
          path: $GITHUB_WORKSPACE/jdk15-HotSpot-SWT_2021-09

  # ======================================================================
  
  jdk15-OpenJ9-SWT_2021-03:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 15 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '15'
          java-package: jdk
          cache: 'maven'

      # - name: Change JDK
      #   run: |
      #     # POM
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      #     # Zipped JDK
      #     sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      #     sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      #     sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      # - name: Change SWT
      #   run: |
      #     # POM
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-03
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-03/Linux-jdk15-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-03/Windows-jdk15-OpenJ9-SWT_2021-03.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-03/MacOS-jdk15-OpenJ9-SWT_2021-03.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk15-OpenJ9-SWT_2021-03
          path: $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-03
  
  # ---

  jdk15-OpenJ9-SWT_2021-06:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 15 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '15'
          java-package: jdk
          cache: 'maven'

      # - name: Change JDK
      #   run: |
      #     # POM
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      #     # Zipped JDK
      #     sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      #     sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      #     sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-06/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-06
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-06/Linux-jdk15-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-06/Windows-jdk15-OpenJ9-SWT_2021-06.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-06/MacOS-jdk15-OpenJ9-SWT_2021-06.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk15-OpenJ9-SWT_2021-06
          path: $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-06
  
  # ---

  jdk15-OpenJ9-SWT_2021-09:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'gama-platform/gama'
          ref: 'GAMA_1.8.2'
      
      - name: Set up AdoptOpenJDK 15 OpenJ9
        uses: actions/setup-java@v2 
        with:
          distribution: 'adopt-openj9'
          java-version: '15'
          java-package: jdk
          cache: 'maven'

      # - name: Change JDK
      #   run: |
      #     # POM
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
      #     sed -i 's/jdk.version>15/jdk.version>11/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      #     # Zipped JDK
      #     sed -i 's/wget \$\(.*linux.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_linux_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_linux_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      #     sed -i 's/wget \$\(.*windows.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_windows_openj9_11.0.11_9_openj9-0.26.0.zip -O "jdk_win_15.zip"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      #     sed -i 's/wget \$\(.*mac_openj9.*\)/wget https:\/\/github.com\/AdoptOpenJDK\/openjdk11-binaries\/releases\/download\/jdk-11.0.11%2B9_openj9-0.26.0\/OpenJDK11U-jdk_x64_mac_openj9_11.0.11_9_openj9-0.26.0.tar.gz -O "jdk_osx_15.tar.gz"/' $GITHUB_WORKSPACE/travis/zip_withjdk.sh

      - name: Change SWT
        run: |
          # POM
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/ummisco.gama.annotations/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.processor/pom.xml
          sed -i 's/releases\/2021-03/releases\/2021-09/g' $GITHUB_WORKSPACE/msi.gama.parent/pom.xml
      
      - name: Build
        run: bash $GITHUB_WORKSPACE/travis/compile.sh
      
      - name: Zip
        run: bash $GITHUB_WORKSPACE/travis/zip_withjdk.sh
      
      - name: Test build headless
        run: bash $GITHUB_WORKSPACE/ummisco.gama.product/target/products/ummisco.gama.application.product/linux/gtk/x86_64/headless/gama-headless.sh -validate 
      
      - name: Prepare releases
        run: |
          mkdir $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-09
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-linux.gtk.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-09/Linux-jdk15-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-win32.win32.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-09/Windows-jdk15-OpenJ9-SWT_2021-09.zip
          mv $GITHUB_WORKSPACE/ummisco.gama.product/target/products/Gama1.7-macosx.cocoa.x86_64_withJDK.zip $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-09/MacOS-jdk15-OpenJ9-SWT_2021-09.zip

      - uses: actions/upload-artifact@master
        with:
          name: jdk15-OpenJ9-SWT_2021-09
          path: $GITHUB_WORKSPACE/jdk15-OpenJ9-SWT_2021-09

  # ======================================================================
  # ----------------------------------------------------------------------
  # ======================================================================

  lets-publish:
    needs: [jdk11-HotSpot-SWT_2021-03, jdk11-HotSpot-SWT_2021-06, jdk11-HotSpot-SWT_2021-09, jdk11-OpenJ9-SWT_2021-03, jdk11-OpenJ9-SWT_2021-06, jdk11-OpenJ9-SWT_2021-09, jdk15-HotSpot-SWT_2021-03, jdk15-HotSpot-SWT_2021-06, jdk15-HotSpot-SWT_2021-09, jdk15-OpenJ9-SWT_2021-03, jdk15-OpenJ9-SWT_2021-06, jdk15-OpenJ9-SWT_2021-09]
    runs-on: ubuntu-latest
    steps:
      - name: Set up AdoptOpenJDK 15 OpenJ9
        run: echo "Everything finished :D" 
